{% extends "layout.html" %} {% block css %} {% endblock %} {% block content %}
<style></style>
<h1>club page</h1>
<h1><a href="/clubupload">업로드</a></h1>
{% for twit in twits %}
<div class="twit">
  <input type="hidden" value="{{twit.User.id}}" class="twit-user-id" />
  <input type="hidden" value="{{twit.id}}" class="twit-id" />
  <div class="twit-author">{{twit.User.nick}}</div>
  {% if not followerIdList.includes(twit.User.id) and twit.User.id !== user.id
  %}
  <button class="twit-follow"><a href="/user">팔로우하기</a></button>
  {% endif %}
  <div class="twit-content">{{twit.content}}</div>
  {% if twit.img %}
  <div class="twit-img">
    <img style="width: 400px" src="{{twit.img}}" alt="섬네일" />
  </div>
  {% endif %}
</div>
{% endfor %} {% endblock %} {% block script %}
<script>
  document.querySelectorAll(".twit-follow").forEach(function (tag) {
    console.log("팔로잉할거냐?이게왜도전클럽에");
    tag.addEventListener("click", function () {
      console.log("팔로잉버튼눌렀냐?");
      var isLoggedIn = document.querySelector("#my-id");
      if (isLoggedIn) {
        console.log("넘어가니?");
        var userId = tag.parentNode.querySelector(".twit-user-id").value;
        var myId = isLoggedIn.value;
        if (userId !== myId) {
          if (confirm("팔로잉하시겠습니까?")) {
            axios
              .post(`/user/${userId}/follow`)
              .then(() => {
                location.reload();
              })
              .catch((err) => {
                console.error(err);
              });
          }
        }
      }
    });
  });
</script>
{% endblock %}
